import{f as _,d as F,e as M,j as s,B as R,h as P,r as h,m as U,an as S,b as c,l as C,a as A}from"./app-4a17Pub4.js";import{u as B}from"./useForm-D-7B7N6w.js";import{h as f}from"./user-IyQLa11_.js";import{T as E}from"./Text-BR9LnClf.js";import{M as g}from"./MultiSelect-Duq5FJlZ.js";import{F as N}from"./Flex-C4-MgrqI.js";import"./index-B6r_j4C5.js";import"./use-resolved-styles-api-nyfOONey.js";import"./OptionsDropdown-B7k9BRCW.js";import"./CheckIcon-BVmRy-LG.js";import"./ScrollArea-BBLLgi1y.js";import"./DirectionProvider-DqDMRz46.js";import"./Combobox-Bd-ojIJS.js";import"./Popover-CBbffI_i.js";import"./use-floating-auto-update-BytyxRVS.js";import"./use-uncontrolled-BGuEEBtS.js";import"./Input-B6kN7ymh.js";import"./create-optional-context-DejgPxvx.js";import"./InputBase-DVeQGwl5.js";import"./Pill-BLrl2ix2.js";import"./PillsInput-B9htvQA-.js";var j={root:"m_18320242","skeleton-fade":"m_299c329c"};const q={visible:!0,animate:!0},T=P((t,{width:r,height:a,radius:l,circle:i})=>({root:{"--skeleton-height":h(a),"--skeleton-width":i?h(a):h(r),"--skeleton-radius":i?"1000px":l===void 0?void 0:U(l)}})),n=_((t,r)=>{const a=F("Skeleton",q,t),{classNames:l,className:i,style:m,styles:d,unstyled:o,vars:u,width:p,height:x,circle:e,visible:v,radius:O,animate:b,mod:w,...y}=a,k=M({name:"Skeleton",classes:j,props:a,className:i,style:m,classNames:l,styles:d,unstyled:o,vars:u,varsResolver:T});return s.jsx(R,{ref:r,...k("root"),mod:[{visible:v,animate:b},w],...y})});n.classes=j;n.displayName="@mantine/core/Skeleton";function V({item:t}){const[r,a]=c.useState(!0),[l,i]=c.useState([]),[m,d]=c.useState([]),[o,u,p]=B("post",route("projects.user_access",t.id),{users:t.users_with_access.filter(e=>!f(e,["admin","client"])).map(e=>e.id.toString()),clients:t.users_with_access.filter(e=>f(e,["client"])&&e.reason!=="company owner").map(e=>e.id.toString())}),x=e=>{u(e,{onSuccess:()=>S.closeAll(),preserveScroll:!0})};return c.useEffect(()=>{C.get(route("dropdown.values",["users","clients"])).then(({data:e})=>{i([...e.users]),d([...e.clients])}).catch(()=>alert("Something went wrong, failed to load dropdown values")).finally(()=>a(!1))},[o.data]),s.jsxs("form",{onSubmit:x,children:[r?s.jsxs(s.Fragment,{children:[s.jsx(n,{height:10,width:50,mt:8,radius:"xl"}),s.jsx(n,{height:25,mt:10,radius:"xl"}),s.jsx(n,{height:10,width:50,mt:25,radius:"xl"}),s.jsx(n,{height:25,mt:10,radius:"xl"})]}):s.jsxs(s.Fragment,{children:[s.jsx(g,{label:"Users",placeholder:"Select users",searchable:!0,value:r?[]:o.data.users,onChange:e=>p("users",e),data:l,error:o.errors.users}),s.jsx(g,{label:"Clients",placeholder:"Select clients",searchable:!0,mt:"md",value:r?[]:o.data.clients,onChange:e=>p("clients",e),data:m,error:o.errors.clients})]}),s.jsx(N,{justify:"flex-end",mt:"xl",children:s.jsx(A,{type:"submit",w:100,disabled:r,loading:o.processing,children:"Save"})})]})}const z=t=>{S.open({title:s.jsx(E,{size:"xl",fw:700,mb:-10,children:"User access"}),centered:!0,padding:"xl",overlayProps:{backgroundOpacity:.55,blur:3},children:s.jsx(V,{item:t})})},ne=z;export{ne as default};
